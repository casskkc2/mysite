<?phpnamespace Home\Event;use Think\Controller;class ExcelEvent extends Controller {		public function export($cols, $rows, $fname) {		error_reporting(E_ALL);		import('Vendor.PHPExcel.Classes.PHPExcel', '', '.php');		$objPHPExcel = new \PHPExcel();		$objPHPExcel->getProperties()->setCreator("sys")									 ->setLastModifiedBy("sys")									 ->setTitle("Excel Document")									 ->setSubject("Excel Document")									 ->setDescription("Excel Document")									 ->setKeywords("openxml php")									 ->setCategory("excel file");									 		$objPHPExcel->setActiveSheetIndex(0);		//$Col_C_Max_Width = 80;// 80/40 * 6 = 12				$col_cfg = array();				foreach($cols as $k=>$col) {			$objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($k, 1, $col);		}				foreach($rows as $k=>$row) {			foreach($row as $j=>$val) {				if (is_array($val)) {					$objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($j, $k+2, $val['text']);					$objPHPExcel->getActiveSheet()->getCellByColumnAndRow($j, $k+2)->getHyperlink()->setUrl($val['url']);				}else{					$objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($j, $k+2, $val);				}			}		}				// Set Sheet Title		$objPHPExcel->getActiveSheet()->setTitle('Sheet1');		// Set 		$styleArray = array( 			//'font' => array( 'bold' => true, ), 			'alignment' => array( 				'horizontal' => \PHPExcel_Style_Alignment::HORIZONTAL_RIGHT, 				'vertical' => \PHPExcel_Style_Alignment::VERTICAL_TOP			), 			/*'borders' => array( 				'top' => array( 'style' => PHPExcel_Style_Border::BORDER_THIN, ), 			), 			'fill' => array( 				'type' => PHPExcel_Style_Fill::FILL_GRADIENT_LINEAR, 				'rotation' => 90, 				'startcolor' => array( 'argb' => 'FFA0A0A0', ), 				'endcolor' => array( 'argb' => 'FFFFFFFF', ), 			), */		);		//$objPHPExcel->getActiveSheet()->getStyle('A2:B3')->applyFromArray($styleArray);		//$objPHPExcel->getActiveSheet()->getColumnDimension('C')->setWidth($Col_C_Max_Width / 40 * 6);//setAutoSize(true);				/*		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'); 		header('Content-Disposition: attachment;filename="' . $fname . '.xlsx"'); 		header('Cache-Control: max-age=0');		$objWriter = \PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');		//$objWriter->save($fpath . '.xlsx');		$objWriter->save('php://output');*/				header('Content-Type: application/vnd.ms-excel'); 		header('Content-Disposition: attachment;filename="' . $fname . '.xls"'); 		header('Cache-Control: max-age=0'); 		$objWriter = \PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel5'); 		$objWriter->save('php://output');	}}